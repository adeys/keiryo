{% extends 'layout.twig' %}

{% block title %} {{ post.title }} {% endblock %}

{% block content %}
    <h1>{{ post.title }}</h1>
    <p>
        <small>
            by {{ post.author }}
            on {{ post.createdAt|date("M dS Y") }}
        </small>
    </p>

    {{ post.content|raw }}

    <p>&nbsp;</p>
    <h3>Comment this post</h3>

    {% if flash.has('success') %}
        {% for success in flash.get('success') %}
            <div>{{ success }}</div>
        {% endfor %}
    {% endif %}

    <form action="{{ route('comment_add', {'post_id': post.id}) }}" method="post" class="col-6">
        <div class="form-group column">
            <label for="pseudo" class="form-label">Pseudo : </label>
            {% if errors.has('pseudo') %}
                <span class="text-error">{{ errors.get('pseudo') }}</span>
            {% endif %}
            <input type="text" id="pseudo" name="pseudo"
                   class="form-input{% if errors.has('pseudo') %} is-error{% endif %}">
        </div>
        <div class="form-group column">
            <label for="email" class="form-label">Email : </label>
            {% if errors.has('email') %}
                <span class="text-error">{{ errors.get('email') }}</span>
            {% endif %}
            <input type="email" id="email" name="email"
                   class="form-input{% if errors.has('email') %} is-error{% endif %}">
        </div>
        <div class="form-group column">
            <label for="content" class="form-label">Comment : </label>
            {% if errors.has('content') %}
                <span class="text-error">{{ errors.get('content') }}</span>
            {% endif %}
            <textarea name="content" id="content" cols="30" rows="5"
                      class="form-input{% if errors.has('content') %} is-error{% endif %}"></textarea>
        </div>
        <div class="form-group column">
            <button class="btn btn-primary">Post a comment</button>
        </div>
    </form>

    <p>&nbsp;</p>
    <h3>{{ post.comments|length }} Comment{% if post.comments|length > 0 %}s{% endif %}</h3>

    {% for comment in post.comments %}
        <div class="row">
            <div class="col-md-10">
                <p><strong>{{ comment.author }}</strong> {{ comment.createdAt|date('M dS Y') }}</p>
                <p>{{ comment.content }}</p>
            </div>
        </div>
    {% endfor %}

{% endblock %}
